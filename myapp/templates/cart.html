{% extends 'base.html' %}
{% block content %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cart View</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/cart.css' %}" />
</head>
<body>
    <div class="cart-container">

        <!-- Timer Section -->
 <div class="countdown-container">
        <div class="countdown-title">Time Left to Buy Items</div>
        <div class="countdown-timer">
            <div class="time-box">
                <span id="number_Days">00</span>
                <p>Days</p>
            </div>
            <div class="colon">:</div>
            <div class="time-box">
                <span id="number_Hours">00</span>
                <p>Hrs</p>
            </div>
            <div class="colon">:</div>
            <div class="time-box">
                <span id="number_Minutes">00</span>
                <p>Mins</p>
            </div>
            <div class="colon">:</div>
            <div class="time-box">
                <span id="number_Seconds">00</span>
                <p>Secs</p>
            </div>
        </div>
         
        <script>
            // Get the time from python using django
            var remainingTime_str = "{{ total_time }}";
            var remainingTime = parseFloat(remainingTime_str);
            console.log(remainingTime);
            
        
            // Define the function that will update the html values
            function updateCountdown(){
                console.log("Entered the function");
                // Get each time units values
                var days = Math.floor(remainingTime / 86400);
                var hours = Math.floor((remainingTime % 86400) / 3600);
                var minutes = Math.floor((remainingTime % 3600) / 60);
                var seconds = Math.floor(remainingTime % 60);
        
                console.log(days)
                console.log(hours)
                
                // Format each unit
                //days_str = String.format("%02d", days);
                //hours_str = String.format("%02d", hours);
                //minutes_str = String.format("%02d", minutes);
                //seconds_str = String.format("%02d", seconds);
        
                // Update the values here
                document.getElementById("number_Days").innerHTML = days;
                document.getElementById("number_Hours").innerHTML = hours;
                document.getElementById("number_Minutes").innerHTML = minutes;
                document.getElementById("number_Seconds").innerHTML = seconds;
        
                // Check to see if no time remains
                if (remainingTime <= 0) {
                        // Set values to 00
                        clearInterval(update);
                        document.getElementById("number_Days").innerHTML = "00";
                        document.getElementById("number_Hours").innerHTML = "00";
                        document.getElementById("number_Minutes").innerHTML = "00";
                        document.getElementById("number_Seconds").innerHTML = "00";
        
                } else {
                        remainingTime--;
                }
            }
            
            // Update the timer every second
            var update = setInterval(updateCountdown, 1000);
        </script>
    </div>
        <!-- Cart items section -->
        <div class="cart-items">
            <h2><center>Your Cart</center></h2>
            <!-- Loop through cart items from the context -->
            {% for item in cart_items %}
                <div class="cart-item">
                    <img src="{% static item.image %}" alt="{{ item.name }}" width="200" height="200">
                    <div class="item-details">
                        <h4>{{ item.name }}</h4>
                        <p>Price: ${{ item.price }} | Size:{{ item.size }} </p>
                    </div>

                    <div class="remove-item">
                        <button class="remove-btn">
                            <img src="{% static 'icons/Trash1.svg' %}" alt="Remove" class="trash-icon">
                        </button>
                    </div>
                </div>
            {% empty %}
                <p>Your cart is empty.</p>
            {% endfor %}
        </div>

        <div class="total-section">
            <p>Items: <span>${{ cart_total|floatformat:2 }}</span></p>
            <p>Shipping: <span>$0.00</span></p>
            <p>Taxes & Fees: <span>$0.00</span></p>
            
            <!-- Custom divider -->
            <div class="divider"></div>
        
            <p>Total: ${{ cart_total|floatformat:2 }}</p>
        </div>

               <!-- Checkout Button -->
        <div class="checkout">
            <button>CHECKOUT</button>
        </div>
    </div>

        </div>
    </div>
</body>
{% endblock %}
